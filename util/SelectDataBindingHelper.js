/*
 * Copyright (C) 2009-2017 SAP SE or an SAP affiliate company. All rights reserved.
 */
sap.ui.define(["jquery.sap.global","sap/ui/base/Object"],function($,O){"use strict";var H=O.extend("fin.re.conmgmts1.util.SelectDataBindingHelper");H.initBlockWithTimeSlice=function(l,s,t,a){l.setTableBindingPath(t);s.attachChange(this.prototype._createOnSliceChangeFunction(l,a,t),this);var b=new sap.ui.core.Item({key:{parts:["Dateto","SAP__Origin"],formatter:function(d,c){if(c){return d.toISOString().slice(0,19)+"__"+c;}else{return d.toISOString().slice(0,19);}}},text:{parts:["Datefrom","Dateto"],formatter:function(d,c){var e=sap.ui.core.format.DateFormat.getDateInstance();return e.format(d)+" - "+e.format(c);}}});s.bindAggregation("items",{path:a,template:b,events:{dataReceived:function(e){var d=e.getParameter("data");if(d&&d.results&&d.results.length>0){var c;var f;var i;for(i=0;i<d.results.length;i++){if(d.results[i].Current){c=d.results[i].Dateto;if(d.results[i].SAP__Origin){f=d.results[i].SAP__Origin;}break;}}var g;if(c==undefined){c=d.results[i-1].Dateto;if(d.results[i-1].SAP__Origin){f=d.results[i-1].SAP__Origin;}}g=c.toISOString().slice(0,19);var h=c.toISOString().slice(0,19);if(f){h+="__"+f;}s.setSelectedKey(h);this.prototype._switchListBindingFromSlice(f,g,l,a,t);}if(s.getId().indexOf('mainPartnerSlice')===-1){s.addItem(new sap.ui.core.Item({key:"All",text:"{i18n>Common.AllTimeSlicesSection}"}));}}.bind(this)}});};H.prototype._createOnSliceChangeFunction=function(l,s,t){return function(e){var a=e.getSource();var k=a.getSelectedItem().getKey();var b=k.indexOf("__");var d;var c;if(b>0){d=k.substring(0,b);c=k.substring(b+2);}else{d=k;}this.prototype._switchListBindingFromSlice(c,d,l,s,t);};};H.prototype._switchListBindingFromSlice=function(s,d,l,a,t){var n;if(d==="All"){n=t;}else{var k="(";if(s){k+="SAP__Origin='"+s+"',";}k+="Dateto=datetime'"+d+"')/";n=a+k+t;}l.setTableBindingPath(n);l.rebindTable(true);};H.prototype._createBindingPath=function(e,k,v){return e+"("+k+"='"+v+"')";};return H;});
